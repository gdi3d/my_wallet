{% extends "base.html" %}
{% block content %}
<div class="row">
	<div class="col-lg-12">
		<table class="table table-striped table-responsive">
			<thead>
				<th>Category</th>
				<th>Amount</th>
				<th>Date</th>
				<th>Note</th>
				<th>Wallet</th>
			</thead>
			<tbody data-bind="foreach: transaction">
				<tr>
					<td data-bind="text: item.category.name"><!-- ko: ifnot: item.category.name -->Unknow<!-- /ko --></td>
					<td data-bind="text: item.amount"></td>
					<td data-bind="text: transaction.date"></td>
					<td data-bind="text: item.note"></td>
					<td data-bind="text: transaction.wallet"></td>
				</tr>
			</tbody>
		</table>
	</div>
</div>
{% endblock %}
{% block inline_js %}
<script type="text/javascript">
	
function Transaction(item, transaction) {
    
    var self = this;
    self.item = item;
    self.transaction = transaction;
}

// Overall viewmodel for this screen, along with initial state
function TransactionViewModel() {
    var self = this;       

	self.transaction = ko.observableArray([]);
	$.getJSON("/api/v1/transactions", function(allData)
	{
        var mappedTransaction = $.map(allData.results, function(v) 
        { 
        	return new Transaction(v.item, {'date': v.date, 'wallet': v.wallet.name}) 
        });
        
        self.transaction(mappedTransaction);
    });
}

ko.applyBindings(new TransactionViewModel());
</script>
{% endblock inline_js %}